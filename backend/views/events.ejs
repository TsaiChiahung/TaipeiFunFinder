<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title><%= title %> | Taipei Fun Finder</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body class="bg-light">

  <%- include('partials/header') %>

  <div class="container my-5">
    <h1 class="mb-4"><%= title %></h1>

    <% if (events.length === 0) { %>
      <div class="alert alert-info" role="alert">
        目前沒有符合條件的活動。
      </div>
    <% } else { %>
      <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
        <% events.forEach(event => { %>
          <div class="col">
            <div class="card h-100 shadow-sm event-card">
              <a href="<%= event.linkUrl %>" target="_blank" rel="noopener noreferrer">
                <img src="<%= event.imageUrl || '/images/default_event.jpg' %>" class="card-img-top" alt="<%= event.title %>">
              </a>
              <div class="card-body">
                <h5 class="card-title"><a href="<%= event.linkUrl %>" target="_blank" rel="noopener noreferrer" class="text-decoration-none text-dark"><%= event.title %></a></h5>
                <p class="card-text text-muted"><%= event.description.substring(0, 80) %>...</p>
              </div>
              <div class="card-footer bg-white border-top-0">
                <small class="text-muted"><%= new Date(event.startDate).toLocaleDateString('zh-TW') %> - <%= new Date(event.endDate).toLocaleDateString('zh-TW') %></small>
              </div>
            </div>
          </div>
        <% }); %>
      </div>
    <% } %>

    <nav aria-label="Page navigation" class="mt-5">
      <ul class="pagination justify-content-center">
        <% if (currentPage > 1) { %>
          <li class="page-item">
            <a class="page-link" href="/events?page=<%= currentPage - 1 %>">上一頁</a>
          </li>
        <% } else { %>
          <li class="page-item disabled">
            <a class="page-link" href="#">上一頁</a>
          </li>
        <% } %>

        <li class="page-item active" aria-current="page">
          <span class="page-link">第 <%= currentPage %> / <%= totalPages %> 頁</span>
        </li>

        <% if (currentPage < totalPages) { %>
          <li class="page-item">
            <a class="page-link" href="/events?page=<%= currentPage + 1 %>">下一頁</a>
          </li>
        <% } else { %>
          <li class="page-item disabled">
            <a class="page-link" href="#">下一頁</a>
          </li>
        <% } %>
      </ul>
    </nav>
  </div>

  <%- include('partials/footer') %>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>